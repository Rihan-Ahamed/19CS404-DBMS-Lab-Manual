# Experiment 3: DML Commands

## AIM
To study and implement DML (Data Manipulation Language) commands.

## THEORY

### 1. INSERT INTO
Used to add records into a relation.
These are three type of INSERT INTO queries which are as
A)Inserting a single record
**Syntax (Single Row):**
```sql
INSERT INTO table_name (field_1, field_2, ...) VALUES (value_1, value_2, ...);
```
**Syntax (Multiple Rows):**
```sql
INSERT INTO table_name (field_1, field_2, ...) VALUES
(value_1, value_2, ...),
(value_3, value_4, ...);
```
**Syntax (Insert from another table):**
```sql
INSERT INTO table_name SELECT * FROM other_table WHERE condition;
```
### 2. UPDATE
Used to modify records in a relation.
Syntax:
```sql
UPDATE table_name SET column1 = value1, column2 = value2 WHERE condition;
```
### 3. DELETE
Used to delete records from a relation.
**Syntax (All rows):**
```sql
DELETE FROM table_name;
```
**Syntax (Specific condition):**
```sql
DELETE FROM table_name WHERE condition;
```
### 4. SELECT
Used to retrieve records from a table.
**Syntax:**
```sql
SELECT column1, column2 FROM table_name WHERE condition;
```
**Question 1**
--
Write a SQL query to Retrieve the medications with dosages equal to the highest dosage

Table Name: Medications (attributes: medication_id, medication_name, dosage)



For example:

Result
medic  medication_name  dosage
-----  ---------------  ---------------
4      Acetaminophen    600mg


```sql
select * from Medications where dosage=(select max(dosage) from Medications);
```

**Output:**

<img width="1090" height="473" alt="image" src="https://github.com/user-attachments/assets/03151ac1-d352-471f-8f95-365fae234a91" />


**Question 2**
---
Write a SQL query to retrieve all columns from the CUSTOMERS table for customers whose Address as Delhi and age below 30

Sample table: CUSTOMERS

ID          NAME        AGE         ADDRESS     SALARY
----------  ----------  ----------  ----------  ----------

1          Ramesh     32              Ahmedabad     2000
2          Khilan        25              Delhi                 1500
3          Kaushik      23              Kota                  2000
4          Chaitali       25             Mumbai            6500
5          Hardik        27              Bhopal              8500
6          Komal         22              Hyderabad       4500

7           Muffy          24              Indore            10000

 
 

For example:

Result
ID          NAME        AGE         ADDRESS     SALARY
----------  ----------  ----------  ----------  ----------
2           Khilan      25          Delhi       1500


```sql
select * from CUSTOMERS where ADDRESS='Delhi' and AGE<30 order by ID;
```

**Output:**

<img width="1254" height="435" alt="image" src="https://github.com/user-attachments/assets/c6cf974d-fa16-43bb-84e5-f8ef3d6345eb" />


**Question 3**
---
Write a SQL query to List departments with names longer than the average length

Departments Table (attributes: department_id, department_name)



For example:

Result
depar  department_name
-----  ---------------
5      Anesthesiologis


```sql
select * from Departments where length(department_name)>(select avg(LENGTH(department_name)) from Departments)
```

**Output:**

<img width="1101" height="497" alt="image" src="https://github.com/user-attachments/assets/d0431c03-134a-454e-8703-4c7999b58bc8" />


**Question 4**
---
Write a SQL query to Find employees who have an age less than the average age of employees with incomes over 2.5 Lakh

Employee Table

name             type

------------   ---------------

id                    INTEGER

name              TEXT

age                 INTEGER

city                 TEXT

income           INTEGER

```sql
select * from Employee where  age<(select avg(age) from Employee where income>250000)
```

**Output:**

<img width="1297" height="562" alt="image" src="https://github.com/user-attachments/assets/82f4cf12-928f-46f5-8c1f-39d18a912e65" />


**Question 5**
---
From the following tables write a SQL query to find all orders generated by London-based salespeople. Return ord_no, purch_amt, ord_date, customer_id, salesman_id.

salesman table

name             type
---------------  ---------------
salesman_id      numeric(5)
name                 varchar(30)
city                    varchar(15)
commission       decimal(5,2)

orders table

name             type
---------------  --------
order_no         int
purch_amt        real
order_date       text
customer_id      int
salesman_id      int
 

For example:

Result
ord_no      purch_amt   ord_date    customer_id  salesman_id
----------  ----------  ----------  -----------  -----------
70009       270.65      2012-09-10  3001         5005

```sql
select ord_no, purch_amt, ord_date, customer_id, salesman_id from orders where salesman_id in (select salesman_id from salesman where city="London");
```

**Output:**

<img width="1278" height="458" alt="image" src="https://github.com/user-attachments/assets/5e471048-4001-492e-ad68-2c90a8c9a394" />


**Question 6**
---
Write a SQL query that retrieves the names of students and their corresponding grades, where the grade is equal to the minimum grade achieved in each subject.

Sample table: GRADES (attributes: student_id, student_name, subject, grade)



For example:

Result
student_name     grade
---------------  ---------------
Bob              85
Frank            85
John             85


```sql
select student_name,grade from GRADES g where grade=(select min(grade) from GRADES where subject=g.subject)
```

**Output:**

<img width="1084" height="526" alt="image" src="https://github.com/user-attachments/assets/9f245217-5f98-45a1-b4ab-7a5d3e833efd" />


**Question 7**
---
Write a SQL query that retrieve all the columns from the table "Grades", where the grade is equal to the maximum grade achieved in each subject.

Sample table: GRADES (attributes: student_id, student_name, subject, grade)



For example:

Result
student_id       student_name     subject          grade
---------------  ---------------  ---------------  ---------------
3                Charlie          Math             95
5                Emma             Science          92
7                John             Social           85


```sql
select * from GRADES g where grade=(select max(grade) from GRADES where subject=g.subject)
```

**Output:**

<img width="1256" height="465" alt="image" src="https://github.com/user-attachments/assets/fe165638-840f-4a55-87a2-aad901d1720e" />


**Question 8**
---
From the following tables, write a SQL query to find all the orders generated in New York city. Return ord_no, purch_amt, ord_date, customer_id and salesman_id.

SALESMAN TABLE

name               type
-----------        ----------
salesman_id  numeric(5)
name             varchar(30)
city                 varchar(15)
commission   decimal(5,2)

ORDERS TABLE

name            type
----------      ----------
ord_no          int
purch_amt    real
ord_date       text
customer_id  int
salesman_id  int

For example:

Result
ord_no      purch_amt   ord_date    customer_id  salesman_id
----------  ----------  ----------  -----------  -----------
70002       65.26       2012-10-05  3002         5001
70005       2400.6      2012-07-27  3007         5001
70008       5760.0      2012-09-10  3002         5001
70013       3045.6      2012-04-25  3002         5001


```sql
select ord_no, purch_amt, ord_date, customer_id,salesman_id from ORDERS where salesman_id in (select salesman_id from SALESMAN WHERE city='New York')
```

**Output:**

<img width="1301" height="579" alt="image" src="https://github.com/user-attachments/assets/9bbcbafb-64c2-41fd-b195-8259db8aad1f" />


**Question 9**
---
Write a SQL query to Retrieve the names and cities of customers who have the same city as customers with IDs 3 and 7

SAMPLE TABLE: customer

name             type
---------------  ---------------
id               INTEGER
name             TEXT
city             TEXT
email            TEXT
phone            INTEGER
For example:

Result
name   city
-----  ---------------
Neha   Bangalore
Rohit  Bangalore
Manoj  Bangalore
Vivek  Chandigarh


```sql
select name ,city from customer where city in (select city from customer where id in (3,7))
```

**Output:**

<img width="1309" height="550" alt="image" src="https://github.com/user-attachments/assets/863822b4-5728-4cd4-9c76-93fe1db75b7b" />


**Question 10**
---
Write a SQL query to retrieve all columns from the CUSTOMERS table for customers whose Address as Delhi

Sample table: CUSTOMERS

ID          NAME        AGE         ADDRESS     SALARY
----------  ----------  ----------  ----------  ----------

1          Ramesh     32              Ahmedabad     2000
2          Khilan        25              Delhi                 1500
3          Kaushik      23              Kota                  2000
4          Chaitali       25             Mumbai            6500
5          Hardik        27              Bhopal              8500
6          Komal         22              Hyderabad       4500

7           Muffy          24              Indore            10000

 
 

For example:

Result
ID          NAME        AGE         ADDRESS     SALARY
----------  ----------  ----------  ----------  ----------
2           Khilan      25          Delhi       1500


```sql
select * from CUSTOMERS where ADDRESS ="Delhi"
```

**Output:**

<img width="1272" height="411" alt="image" src="https://github.com/user-attachments/assets/3d8f7912-c274-45e4-a982-14a03fd41c43" />


## RESULT
Thus, the SQL queries to implement DML commands have been executed successfully.
